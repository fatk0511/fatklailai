<!DOCTYPE html>
<html>
    <head>
        <title>FatK&LAILAI_LevelUP</title>
        <link rel="icon" href="ico.png">
        <link rel="stylesheet" href="topbar.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    </head>
<body>
<!--Firebase------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-analytics.js";
        const firebaseConfig = {
            apiKey: "AIzaSyDhjqsFWt7iKxnHlghBWQ9iXJxDTJ7aCkM",
            authDomain: "fir-2022-32ba3.firebaseapp.com",
            projectId: "fir-2022-32ba3",
            storageBucket: "fir-2022-32ba3.appspot.com",
            messagingSenderId: "836534365410",
            appId: "1:836534365410:web:2db014936bfdb699e542bb",
            measurementId: "G-J4GER0PP4M"
          };
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        import {getDatabase, ref, set, child, get, update, push, onChildAdded, onChildChanged, onChildRemoved} from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";
        const db = getDatabase();
        const dbref = ref(db);
//<!--Startup FUN
        function startupload(){
                get(child(dbref, "User/")).then((snapshot)=>{
                    document.getElementById("topbarpoint").innerHTML = snapshot.val().LAILAI.point;
                    document.getElementById("topbarpoint2").innerHTML = snapshot.val().LAILAI.point;
                });
        }window.onload = function() {setInterval(startupload, 1000);}
    
//<!--æ¯æ—¥ç°½åˆ° FUN
        var dailyCheck = document.getElementById("dailyCheck");
        var dailyCheck2 = document.getElementById("dailyCheck2");
        dailyCheck.addEventListener('click', dailyCheckAction);
        dailyCheck2.addEventListener('click', dailyCheckAction);
        var Today=new Date();
        //alert(Today.getDate());
        function dailyCheckAction(){
            const temp = confirm("æ¯æ—¥ç°½åˆ°?");
            if(temp){
                get(child(dbref, "User/")).then((snapshot)=>{
                    if(snapshot.val().LAILAI.today!=Today.getDate()){
                        var tempPoint = snapshot.val().LAILAI.point;
                        tempPoint = tempPoint + 1;
                        update(ref(db, "User/"+ "LAILAI"),{
                            point: tempPoint,
                            today: Today.getDate()
                        });
                        alert("ç°½åˆ°æˆåŠŸ.");
                    }else{
                        alert("å·²ç¶“ç°½åˆ°.");
                    }
                });
            }else{
                alert("Cancelled.")
            }
        }
    </script>
<!--Firebase End------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
    <!-- TOP BAR -->
    <div id="topbar">
        <div class="dropdown">
            <a href="#" class="dropbtn">&nbsp;&nbsp;<button class="btn"><i class="fa fa-bars"></i></button></a>
            <div class="dropdown-content">
                <a href="#">ğŸ“šåœ–æ›¸é¤¨</a>
                <a href="#">ç©åˆ†:<span id="topbarpoint">Loading...</span></a>
                <a href="timeM.html">ğŸï¸æ™‚å…‰è† å·</a>
                <a href="index.html">ğŸƒè¿”å›ç›®éŒ„</a>
                <a href="#" id="dailyCheck">âœï¸æ¯æ—¥ç°½åˆ°</a>
            </div>
        </div>
        <font color="#F0F0F0" valign="center">
		<table class="topbarlist" cellpadding="0">
			<td>â—.é‡å¤§å›é¡§: æ›´æ–°ç©åˆ†ç³»çµ±,1124å¤§æŠ½ç,æ™‚å…‰è† å·é–‹æ”¾ä¸­.â—</td>
			<td>ğŸ“šåœ–æ›¸é¤¨&nbsp;&nbsp;</td>
			<td>ç©åˆ†:<font size=3 id="topbarpoint2">Loading...</font></td>
			<td><a href=timeM.html>ğŸï¸æ™‚å…‰è† å·</a></td>
			<td><a href=index.html>ğŸƒè¿”å›ç›®éŒ„</a></td>
			<td><a id="dailyCheck2">âœï¸æ¯æ—¥ç°½åˆ°</a></td>
		</table>
        </font>
    </div>
    
    <script src="topbar.js"></script>
    <!-- TOP BAR END -->
</body> 
</html>
